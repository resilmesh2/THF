# ==============================================================================
# THF (Threat Hunting Framework) - Environment Configuration Template
# ==============================================================================
# Copy this file to .env and fill in your actual values
# Command: cp .env.example .env
#
# IMPORTANT: Never commit your .env file with real credentials to git!
# ==============================================================================

# ==============================================================================
# ANTHROPIC AI CONFIGURATION (REQUIRED)
# ==============================================================================
# Get your API key from: https://console.anthropic.com/
# This is required for the Claude AI-powered security analysis
ANTHROPIC_API_KEY=sk-ant-api03-your-anthropic-api-key-here

# ==============================================================================
# OPENSEARCH CONFIGURATION (REQUIRED)
# ==============================================================================
# Connection details for your Wazuh OpenSearch cluster
# The application queries alert data from OpenSearch

# Hostname or IP address of your OpenSearch server
OPENSEARCH_HOST=localhost

# OpenSearch port (default: 9200)
OPENSEARCH_PORT=9200

# OpenSearch authentication credentials
OPENSEARCH_USER=admin
OPENSEARCH_PASSWORD=your-opensearch-password-here

# SSL/TLS settings for OpenSearch connection
OPENSEARCH_USE_SSL=true
OPENSEARCH_VERIFY_CERTS=false

# ==============================================================================
# WAZUH API CONFIGURATION (REQUIRED)
# ==============================================================================
# Connection details for Wazuh API (agent management and system queries)

# Hostname or IP address of your Wazuh manager
WAZUH_API_HOST=localhost

# Wazuh API port (default: 55000)
WAZUH_API_PORT=55000

# Wazuh API authentication credentials
WAZUH_API_USERNAME=wazuh
WAZUH_API_PASSWORD=your-wazuh-api-password-here

# SSL/TLS settings for Wazuh API connection
WAZUH_API_USE_SSL=true
WAZUH_API_VERIFY_CERTS=false

# ==============================================================================
# REDIS CONFIGURATION (OPTIONAL)
# ==============================================================================
# Redis is used for caching query results and session management
# The application can run without Redis, but caching improves performance

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================
# General application settings

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# FastAPI backend server configuration
API_HOST=0.0.0.0
API_PORT=8000

# Environment: development, staging, production
ENVIRONMENT=development

# ==============================================================================
# AUTHENTICATION & SECURITY (OPTIONAL)
# ==============================================================================
# JWT settings for API authentication
# Generate a secure secret key: openssl rand -hex 32

JWT_SECRET_KEY=your-jwt-secret-key-here-generate-with-openssl-rand-hex-32
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ==============================================================================
# LANGSMITH MONITORING (OPTIONAL)
# ==============================================================================
# LangSmith provides observability for LangChain agent interactions
# Get your API key from: https://smith.langchain.com/
# Set to 'false' to disable tracing and save API costs

LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=your-langsmith-api-key-here
LANGCHAIN_PROJECT=wazuh-llm-assistant

# ==============================================================================
# RATE LIMITING (OPTIONAL)
# ==============================================================================
# Configure API rate limits to prevent abuse

# Maximum number of requests allowed
RATE_LIMIT_REQUESTS=100

# Time period in seconds
RATE_LIMIT_PERIOD=60

# ==============================================================================
# CACHING CONFIGURATION (OPTIONAL)
# ==============================================================================
# Query result caching settings

# Enable or disable caching (true/false)
ENABLE_CACHING=true

# Cache time-to-live in seconds (default: 5 minutes)
CACHE_TTL=300

# ==============================================================================
# WAZUH INDEX CONFIGURATION
# ==============================================================================
# OpenSearch index patterns for Wazuh data
# Default patterns work for standard Wazuh installations

# Wazuh alerts index pattern
WAZUH_ALERTS_INDEX=wazuh-alerts-*

# Wazuh monitoring index pattern
WAZUH_MONITORING_INDEX=wazuh-monitoring-*

# Wazuh archives index pattern
WAZUH_ARCHIVES_INDEX=wazuh-archives-*

# ==============================================================================
# WAZUH ANOMALY DETECTION PLUGIN INDICES (OPTIONAL)
# ==============================================================================
# OpenSearch Anomaly Detection plugin result indices
# Only needed if you're using Wazuh's anomaly detection plugin features

THRESHOLD_DETECTOR_INDEX=opensearch-ad-plugin-result-alert-threshold-*
TREND_DETECTOR_INDEX=opensearch-ad-plugin-result-alert-trend-*
BEHAVIOUR_DETECTOR_INDEX=opensearch-ad-plugin-result-alert-behaviour-*

# ==============================================================================
# DOCKER-SPECIFIC CONFIGURATION
# ==============================================================================
# When running in Docker, you may need to adjust these settings:
#
# 1. For OpenSearch/Wazuh running on host machine:
#    - Windows/Mac: Use 'host.docker.internal' instead of 'localhost'
#    - Linux: Use your machine's IP address or Docker bridge IP
#
# 2. For OpenSearch/Wazuh running in other Docker containers:
#    - Use the container name or service name from docker-compose.yml
#
# Example for host machine access from Docker:
# OPENSEARCH_HOST=host.docker.internal
# WAZUH_API_HOST=host.docker.internal
#
# ==============================================================================
